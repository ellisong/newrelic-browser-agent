# This workflow is used to tag a new prerelease version

name: Tag Prerelease Version

on:
  workflow_dispatch:
    inputs:
      version-type:
        description: "The type of version bump to make. One of: major, minor, patch, premajor, preminor, prepatch, or prerelease."
        type: string
        required: true
      preid:
        description: "The prerelease identifier to use when bumping a prerelease version."
        type: string
        required: true
        default: rc

jobs:
  tag-prerelease-version:
    runs-on: ubuntu-latest
    defaults:
      run:
        shell: bash
    env:
      NPM_TOKEN: ${{ secrets.BROWSER_NPM_TOKEN }}
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: 22.11.0 # See package.json for the stable node version that works with our testing.  Do not change this unless you know what you are doing as some node versions do not play nicely with our testing server.
      - name: Authenticate npm
        run: |
          npm config set '//registry.npmjs.org/:_authToken' "${NPM_TOKEN}"
      - uses: ./.github/actions/tag-prerelease-version
        with:
          version-type: ${{ inputs.version-type }}
          preid: ${{ inputs.preid }}
